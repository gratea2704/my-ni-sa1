<!DOCTYPE html>
<html lang="th">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>à¸ªà¸²à¸£à¸ à¸²à¸à¹„à¸¡à¹ˆà¹€à¸›à¸´à¸”à¹€à¸œà¸¢à¸•à¸±à¸§à¸•à¸™</title>

<style>
/* === CSS à¹€à¸”à¸´à¸¡à¸‚à¸­à¸‡à¹€à¸˜à¸­ (à¹„à¸¡à¹ˆà¹€à¸›à¸¥à¸µà¹ˆà¸¢à¸™) === */
*{margin:0;padding:0;box-sizing:border-box}
body{
font-family:'Segoe UI',Tahoma,Geneva,Verdana,sans-serif;
background:linear-gradient(135deg,#667eea 0%,#764ba2 100%);
min-height:100vh;display:flex;justify-content:center;align-items:center;padding:20px
}
.container{
background:rgba(255,255,255,.95);
border-radius:20px;
box-shadow:0 20px 40px rgba(0,0,0,.1);
padding:40px;max-width:600px;width:100%
}
.header{text-align:center;margin-bottom:30px}
.header h1{font-size:2.5em;margin-bottom:10px}
.stats{text-align:center;margin-bottom:30px;padding:20px;background:rgba(102,126,234,.1);border-radius:15px}
.form-group{margin-bottom:20px}
label{display:block;margin-bottom:8px;font-weight:600}
textarea,select{
width:100%;padding:12px;border-radius:10px;border:2px solid #e1e1e1;font-size:16px
}
.submit-btn{
width:100%;padding:15px;border:none;border-radius:25px;
background:linear-gradient(135deg,#667eea 0%,#764ba2 100%);
color:white;font-size:18px;cursor:pointer
}
.confession-item{
background:#f8f9fa;border-radius:15px;padding:20px;margin-bottom:20px;
border-left:5px solid #667eea
}
.confession-meta{display:flex;justify-content:space-between;margin-bottom:10px;font-size:.9em}
.anonymous-id{font-weight:600;color:#764ba2}
</style>
</head>

<body>

<div class="container">
  <div class="header">
    <h1>ğŸ’­ à¸ªà¸²à¸£à¸ à¸²à¸à¹ƒà¸ˆ</h1>
    <p>à¹à¸šà¹ˆà¸‡à¸›à¸±à¸™à¸„à¸§à¸²à¸¡à¹ƒà¸™à¹ƒà¸ˆà¹à¸šà¸šà¹„à¸¡à¹ˆà¹€à¸›à¸´à¸”à¹€à¸œà¸¢à¸•à¸±à¸§à¸•à¸™</p>
  </div>

  <div class="stats">
    <h3>ğŸ“Š à¸ªà¸–à¸´à¸•à¸´à¸à¸²à¸£à¸ªà¸²à¸£à¸ à¸²à¸</h3>
    <p>à¸¡à¸µà¸„à¸™à¸ªà¸²à¸£à¸ à¸²à¸à¹à¸¥à¹‰à¸§ <span id="confessionCount">0</span> à¸„à¸£à¸±à¹‰à¸‡</p>
  </div>

  <form id="confessionForm">
    <div class="form-group">
      <label>à¸«à¸¡à¸§à¸”à¸«à¸¡à¸¹à¹ˆ</label>
      <select id="category" required>
        <option value="">à¹€à¸¥à¸·à¸­à¸à¸«à¸¡à¸§à¸”à¸«à¸¡à¸¹à¹ˆ</option>
        <option value="à¸„à¸§à¸²à¸¡à¸£à¸±à¸">ğŸ’• à¸„à¸§à¸²à¸¡à¸£à¸±à¸</option>
        <option value="à¸„à¸£à¸­à¸šà¸„à¸£à¸±à¸§">ğŸ‘¨â€ğŸ‘©â€ğŸ‘§â€ğŸ‘¦ à¸„à¸£à¸­à¸šà¸„à¸£à¸±à¸§</option>
        <option value="à¹€à¸à¸·à¹ˆà¸­à¸™">ğŸ‘« à¹€à¸à¸·à¹ˆà¸­à¸™</option>
        <option value="à¸à¸²à¸£à¸‡à¸²à¸™">ğŸ’¼ à¸à¸²à¸£à¸‡à¸²à¸™</option>
        <option value="à¸„à¸§à¸²à¸¡à¸¥à¸±à¸š">ğŸ¤« à¸„à¸§à¸²à¸¡à¸¥à¸±à¸š</option>
      </select>
    </div>

    <div class="form-group">
      <label>à¸ªà¸´à¹ˆà¸‡à¸—à¸µà¹ˆà¸­à¸¢à¸²à¸à¸ªà¸²à¸£à¸ à¸²à¸</label>
      <textarea id="confession" required></textarea>
    </div>

    <button class="submit-btn">ğŸš€ à¸ªà¹ˆà¸‡à¸à¸²à¸£à¸ªà¸²à¸£à¸ à¸²à¸</button>
  </form>

  <div style="margin-top:40px">
    <h2 style="text-align:center">ğŸ’¬ à¸à¸²à¸£à¸ªà¸²à¸£à¸ à¸²à¸à¸¥à¹ˆà¸²à¸ªà¸¸à¸”</h2>
    <div id="confessionsList"></div>
  </div>
</div>

<!-- ğŸ”¥ Firebase SDK -->
<script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore-compat.js"></script>

<script>
/* ===== à¹ƒà¸ªà¹ˆ firebaseConfig à¸‚à¸­à¸‡à¹€à¸˜à¸­à¸•à¸£à¸‡à¸™à¸µà¹‰ ===== */
const firebaseConfig = {
  apiKey: "AIzaSyAriXgtw7Ko0ErVuP0pHtnN3v_EnG2PW50",
  authDomain: "chanidapa-efdc0.firebaseapp.com",
  projectId: "chanidapa-efdc0",
  storageBucket: "chanidapa-efdc0.firebasestorage.app",
  messagingSenderId:"1:113317187939:web:ad57f628b722a9f2c9c356",
  appId: "G-YG2MYFN517"
};

firebase.initializeApp(firebaseConfig);
const db = firebase.firestore();

/* ===== à¸Ÿà¸±à¸‡à¸à¹Œà¸Šà¸±à¸™ ===== */
function randomId(){
 const a=['à¸¥à¸¶à¸à¸¥à¸±à¸š','à¸«à¸§à¸²à¸™','à¹€à¸‡à¸µà¸¢à¸š','à¸à¸±à¸™à¸”à¸µ','à¹€à¸¨à¸£à¹‰à¸²'];
 const b=['à¸™à¸','à¸”à¸²à¸§','à¸Ÿà¹‰à¸²','à¹ƒà¸ˆ','à¹€à¸‡à¸²'];
 return a[Math.floor(Math.random()*a.length)] +
        b[Math.floor(Math.random()*b.length)] +
        Math.floor(Math.random()*999);
}

document.getElementById("confessionForm").addEventListener("submit",async e=>{
 e.preventDefault();
 const text=confession.value.trim();
 const cat=category.value;
 if(!text||!cat) return alert("à¸à¸£à¸­à¸à¹ƒà¸«à¹‰à¸„à¸£à¸š");

 await db.collection("confessions").add({
   text,category:cat,
   anonymousId:randomId(),
   createdAt:firebase.firestore.FieldValue.serverTimestamp()
 });

 confession.value="";
 category.value="";
});

/* ===== à¹à¸ªà¸”à¸‡à¸‚à¹‰à¸­à¸¡à¸¹à¸¥ ===== */
db.collection("confessions")
 .orderBy("createdAt","desc")
 .onSnapshot(snap=>{
   confessionCount.textContent=snap.size;
   confessionsList.innerHTML="";
   snap.forEach(d=>{
     const c=d.data();
     confessionsList.innerHTML+=`
     <div class="confession-item">
       <div class="confession-meta">
         <span class="anonymous-id">ğŸ‘¤ ${c.anonymousId}</span>
         <span>${c.category}</span>
       </div>
       <div>${c.text}</div>
     </div>`;
   });
 });
</script>

</body>
</html>
